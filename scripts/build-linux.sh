#!/bin/bash

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# WitNote Linux æž„å»ºè„šæœ¬
# ç”¨é€”: æž„å»º AppImage å’Œ Deb å®‰è£…åŒ…
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${BLUE}       WitNote Linux æž„å»ºå·¥å…·                                  ${NC}"
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"

# èŽ·å–ç‰ˆæœ¬å·
VERSION=$(grep '"version":' package.json | sed 's/.*"version": "\(.*\)".*/\1/')
echo -e "ðŸ“¦ å½“å‰ç‰ˆæœ¬: ${GREEN}$VERSION${NC}"

# è®¾ç½®çŽ¯å¢ƒå˜é‡ (Linux ä¸æ”¯æŒ WebLLM)
export DISABLE_WEBLLM=true
echo -e "ðŸ”§ DISABLE_WEBLLM: ${YELLOW}true${NC} (Linux ä¸æ”¯æŒ WebLLM)"

# æ¸…ç†æ—§æž„å»º
echo -e "\n${YELLOW}[Step 1] æ¸…ç†æ—§æž„å»º...${NC}"
rm -rf release/*linux* release/*Linux* release/*.AppImage release/*.deb 2>/dev/null || true
echo -e "âœ… æ¸…ç†å®Œæˆ"

# è¿è¡Œæž„å»º
echo -e "\n${YELLOW}[Step 2] æž„å»º Linux ç‰ˆæœ¬...${NC}"
echo -e "æ‰§è¡Œ: npm run build:linux"
npm run build:linux

# å®Œæˆ
echo -e "\n${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${GREEN}âœ… Linux æž„å»ºå®Œæˆï¼${NC}"
echo -e "${GREEN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "\nðŸ“¦ è¾“å‡ºç›®å½•: ${BLUE}release/${NC}"
echo -e "\nç”Ÿæˆçš„æ–‡ä»¶:"
ls -la release/*.AppImage release/*.deb 2>/dev/null || echo "  (è¯·æ£€æŸ¥ release/ ç›®å½•)"
echo ""
